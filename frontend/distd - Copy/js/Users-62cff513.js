var O=Object.defineProperty,q=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var y=(n,s,e)=>s in n?O(n,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[s]=e,U=(n,s)=>{for(var e in s||(s={}))T.call(s,e)&&y(n,e,s[e]);if(x)for(var e of x(s))z.call(s,e)&&y(n,e,s[e]);return n},_=(n,s)=>q(n,F(s));import{l as A,k as L,r as w,p as M,o as l,h as i,q as b,t as d,s as c,F as g,v as V,n as P,A as $,x as p,C as f,B as G,N as H}from"./vendor-943aface.js";import{a as j,_ as J,e as K}from"./index-b96ce60d.js";import{_ as Q}from"./Toggle-edd22afa.js";const R=["textContent"],W=["onClick","textContent"],X=["textContent"],Y={key:1,class:"invite"},re={props:{server:{type:Object,required:!0}},setup(n){const s=n,{t:e,te:N,locale:S}=A(),C=L("toast"),v=w([]),u=w(""),h=["server.view","server.admin","server.delete","server.definition.view","server.definition.edit","server.data.view","server.data.edit","server.data.edit.admin","server.flags.view","server.flags.edit","server.name.edit","server.users.view","server.users.create","server.users.edit","server.users.delete","server.start","server.stop","server.kill","server.install","server.files.view","server.files.edit","server.sftp","server.console","server.console.send","server.stats","server.status"].map(t=>{const a={label:e("scopes.name."+t.replace(/\./g,"-")),name:t};return N("scopes.hint."+t.replace(/\./g,"-"),S)&&(a.hint=e("scopes.hint."+t.replace(/\./g,"-"))),a});async function B(){const t={email:u.value};await s.server.updateUser(t),C.success(e("users.UserInvited")),m()}async function I(t){const a=Object.keys(t.scopes).filter(o=>t.scopes[o]),r=_(U({},t),{scopes:a});await s.server.updateUser(r),C.success(e("users.UpdateSuccess"))}async function D(t){await s.server.deleteUser(t.email),m()}async function m(){const t=await s.server.getUsers();v.value=t.map(a=>{const r={};return h.map(o=>{r[o.name]=a.scopes.indexOf(o.name)>-1}),a.scopes=r,a})}function E(t){return s.server.hasScope("server.users.edit")?!s.server.hasScope(t):!0}return M(async()=>{m()}),(t,a)=>(l(),i("div",null,[b("h2",{textContent:d(c(e)("users.Users"))},null,8,R),(l(!0),i(g,null,V(v.value,r=>(l(),i("div",{key:r.email,class:P(["user",r.open?"open":"closed"])},[b("h3",{onClick:o=>r.open=!r.open,textContent:d(r.username)},null,8,W),(l(!0),i(g,null,V(c(h),o=>(l(),$(Q,{key:o.name,modelValue:r.scopes[o.name],"onUpdate:modelValue":[k=>r.scopes[o.name]=k,k=>I(r)],disabled:E(o.name),label:o.label,hint:o.hint},null,8,["modelValue","onUpdate:modelValue","disabled","label","hint"]))),128)),n.server.hasScope("server.users.delete")?(l(),$(j,{key:0,color:"error",onClick:o=>D(r),textContent:d(c(e)("users.Delete"))},null,8,["onClick","textContent"])):p("",!0)],2))),128)),v.value.length===0?(l(),i("div",{key:0,class:"no-users",textContent:d(c(e)("servers.NoUsers"))},null,8,X)):p("",!0),n.server.hasScope("server.users.create")?(l(),i("div",Y,[f(J,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=r=>u.value=r),type:"email",icon:"email",label:c(e)("users.Email")},null,8,["modelValue","label"]),f(j,{color:"primary",onClick:a[1]||(a[1]=r=>B())},{default:G(()=>[f(K,{name:"plus"}),H(d(c(e)("servers.InviteUser")),1)]),_:1})])):p("",!0)]))}};export{re as default};
//# sourceMappingURL=Users-62cff513.js.map
