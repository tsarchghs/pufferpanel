{"version":3,"file":"Files-3b0dd67f.js","sources":["../../src/components/server/files/Editor.vue","../../src/components/server/files/Upload.vue","../../src/components/server/Files.vue"],"sourcesContent":["<script>\nimport { useI18n } from 'vue-i18n'\nimport Ace from '@/components/ui/Ace.vue'\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\n\nconst extensions = {}\n// image formats\nextensions['.jpg']  = { type: 'image', disableSave: true }\nextensions['.jpeg'] = { type: 'image', disableSave: true }\nextensions['.png']  = { type: 'image', disableSave: true }\nextensions['.gif']  = { type: 'image', disableSave: true }\n// audio formats\nextensions['.mp3']  = { type: 'audio', disableSave: true }\nextensions['.wav']  = { type: 'audio', disableSave: true }\nextensions['.ogg']  = { type: 'audio', disableSave: true }\nextensions['.flac'] = { type: 'audio', disableSave: true }\nextensions['.aac']  = { type: 'audio', disableSave: true }\nextensions['.alac'] = { type: 'audio', disableSave: true }\n// video formats\nextensions['.mp4']  = { type: 'video', disableSave: true }\nextensions['.webm'] = { type: 'video', disableSave: true }\nextensions['.avi']  = { type: 'video', disableSave: true }\nextensions['.mkv']  = { type: 'video', disableSave: true }\nextensions['.m4a']  = { type: 'video', disableSave: true }\n\nfunction getType(file) {\n  return (extensions[file.extension] || {}).type\n}\n\nexport function skipDownload(file) {\n  return ['image', 'audio', 'video'].indexOf(getType(file)) !== -1\n}\n\nexport default {\n  components: {\n    Ace,\n    Btn,\n    Icon\n  },\n  props: {\n    readOnly: { type: Boolean, default: () => false },\n    modelValue: { type: Object, required: true }\n  },\n  emits: ['update:modelValue', 'save', 'close'],\n  setup(props, { emit }) {\n    const { t } = useI18n()\n\n    function emitUpdate(event) {\n      emit('update:modelValue', { ...props.modelValue, content: event })\n    }\n\n    return { t, emit, emitUpdate, extensions, getType, skipDownload }\n  }\n}\n</script>\n\n<template>\n  <div>\n    <div class=\"overlay-header\">\n      <h1 class=\"title\" v-text=\"modelValue.name\" />\n      <btn v-if=\"!readOnly && !((extensions[modelValue.extension] || {}).disableSave)\" variant=\"text\" @click=\"emit('save')\"><icon name=\"save\" /> {{ t('common.Save') }}</btn>\n      <btn v-hotkey=\"'Escape'\" variant=\"icon\" @click=\"emit('close')\"><icon name=\"close\" /></btn>\n    </div>\n    <img v-if=\"getType(modelValue) === 'image'\" class=\"file-viewer\" :src=\"modelValue.url\" />\n    <video v-else-if=\"getType(modelValue) === 'video'\" class=\"file-viewer\" controls>\n      <source :src=\"modelValue.url\" />\n      <div class=\"warning unsupported\" v-text=\"t('errors.VideoUnsupported')\" />\n    </video>\n    <audio v-else-if=\"getType(modelValue) === 'audio'\" class=\"file-viewer\" controls>\n      <source :src=\"modelValue.url\" />\n      <div class=\"warning unsupported\" v-text=\"t('errors.AudioUnsupported')\" />\n    </audio>\n    <ace v-else id=\"file-editor\" :read-only=\"readOnly\" :model-value=\"modelValue.content\" class=\"file-editor\" :file=\"modelValue.name\" theme=\"monokai\" @update:modelValue=\"emitUpdate\" />\n  </div>\n</template>\n","<script setup>\nimport { ref, inject } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\nimport Overlay from '@/components/ui/Overlay.vue'\n\nconst { t } = useI18n()\nconst toast = inject('toast')\n\nconst props = defineProps({\n  server: { type: Object, required: true },\n  folder: { type: Boolean, default: () => false },\n  hotkey: { type: String, default: () => undefined },\n  path: { type: String, required: true }\n})\n\nconst emit = defineEmits(['uploaded'])\n\nconst input = ref(null)\nconst uploading = ref(false)\nconst uploadState = ref(null)\n\nfunction trigger() {\n  input.value.click()\n}\n\nasync function prepareFolders(files) {\n  uploadState.value = { state: 'create folders' }\n  const toCreate = new Set()\n  const exist = new Set()\n  for (let i = 0; i < files.length; i++) {\n    let filePath = files[i].webkitRelativePath.split('/')\n    filePath.pop()\n    filePath = [props.path, ...filePath].join('/')\n    if (toCreate.has(filePath) || exist.has(filePath)) continue\n    const type = await props.server.fileExists(filePath)\n\n    if (!type) toCreate.add(filePath)\n    if (type === 'folder') exist.add(filePath)\n    if (type === 'file') throw `${filePath} exists as file`\n  }\n\n  for (let path of toCreate) {\n    await props.server.createFolder(path)\n  }\n}\n\nfunction onUploadProgress(event) {\n  const i = uploadState.value.current\n  const file = uploadState.value.files[i]\n  file.progress = Math.min(event.loaded, file.size)\n}\n\nasync function uploadFiles(event) {\n  uploadState.value = { state: 'preparing' }\n  uploading.value = true\n  try {\n    if (event.target.webkitdirectory) await prepareFolders(event.target.files)\n    uploadState.value = {\n      state: 'upload files',\n      current: 0,\n      total: event.target.files.length,\n      files: []\n    }\n    for (let i = 0; i < event.target.files.length; i++) {\n      const file = event.target.files[i]\n      uploadState.value.files[i + 1] = {\n        name: file.webkitRelativePath || file.name,\n        size: file.size,\n        progress: 0\n      }\n    }\n    for (let i = 0; i < event.target.files.length; i++) {\n      uploadState.value.current = i + 1\n      const file = event.target.files[i]\n      let path = props.path + '/'\n      if (file.webkitRelativePath) {\n        path = path + file.webkitRelativePath\n      } else {\n        path = path + file.name\n      }\n      await props.server.uploadFile(path, file, onUploadProgress)\n    }\n  } catch(e) {\n    console.error('file upload failed', e)\n    toast.error(t('files.UploadFailed'))\n  } finally {\n    toast.success(t('files.UploadSuccess'))\n    emit('uploaded')\n    uploading.value = false\n    uploadState.value = null\n  }\n}\n</script>\n\n<template>\n  <div>\n    <btn v-hotkey=\"hotkey\" variant=\"icon\" :tooltip=\"t(folder ? 'files.UploadFolder' : 'files.UploadFile')\" @click=\"trigger()\">\n      <icon :name=\"folder ? 'folder-upload' : 'file-upload'\" />\n    </btn>\n    <input ref=\"input\" type=\"file\" multiple :webkitdirectory=\"folder\" @change=\"uploadFiles\" />\n    <overlay v-model=\"uploading\" class=\"file-upload-progress\" :title=\"t('files.UploadProgress')\">\n      <div v-if=\"uploadState.state === 'preparing'\">\n        <div class=\"progress\">\n          <span v-text=\"t('files.PreparingUpload')\" />\n          <progress />\n        </div>\n      </div>\n      <div v-if=\"uploadState.state === 'create folders'\">\n        <div class=\"progress\">\n          <span v-text=\"t('files.CreatingFolders')\" />\n          <progress />\n        </div>\n      </div>\n      <div v-if=\"uploadState.state === 'upload files'\">\n        <div class=\"upload-file-count\" v-text=\"t('files.CurrentlyUploading', { current: uploadState.current, total: uploadState.total })\" />\n        <div class=\"upload-file-name\" v-text=\"uploadState.files[uploadState.current].name\" />\n        <div class=\"progress\">\n          <span v-text=\"t('files.Current')\" />\n          <progress\n            :max=\"uploadState.files[uploadState.current].size\"\n            :value=\"uploadState.files[uploadState.current].progress\"\n          />\n        </div>\n        <div class=\"progress\">\n          <span v-text=\"t('files.Total')\" />\n          <progress\n            :max=\"uploadState.files.reduce((a, b) => a + b.size, 0)\"\n            :value=\"uploadState.files.reduce((a, b) => a + b.progress, 0)\"\n          />\n        </div>\n      </div>\n    </overlay>\n  </div>\n</template>\n","<script setup>\nimport { ref, onMounted, onUnmounted, inject } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\nimport Loader from '@/components/ui/Loader.vue'\nimport Overlay from '@/components/ui/Overlay.vue'\nimport Editor, { skipDownload } from './files/Editor.vue'\nimport Upload from './files/Upload.vue'\nimport TextField from '@/components/ui/TextField.vue'\n\nconst { t } = useI18n()\nconst events = inject('events')\n\nconst props = defineProps({\n  server: { type: Object, required: true }\n})\n\nconst allowDirectoryUpload = 'webkitdirectory' in document.createElement('input')\nconst canEdit = props.server.hasScope('server.files.edit')\n\nconst fileEls = ref([])\nconst files = ref(null)\nconst file = ref(null)\nconst fileSizeWarn = ref(false)\nconst fileSizeWarnSubject = ref(null)\nconst currentPath = ref([])\nconst editorOpen = ref(false)\nconst loading = ref(false)\nconst createFileOpen = ref(false)\nconst createFolderOpen = ref(false)\nconst newItemName = ref('')\n\nlet task\nlet unbindEvent\nonMounted(() => {\n  refresh()\n\n  unbindEvent = props.server.on('status', () => {\n    refresh()\n  })\n\n  task = props.server.startTask(() => {\n    refresh()\n  }, 5 * 60 * 1000)\n})\n\nonUnmounted(async () => {\n  if (unbindEvent) unbindEvent()\n  if (task) props.server.stopTask(task)\n})\n\nasync function refresh(manual = false) {\n  if (manual) files.value = null // cause visual feedback on manual refresh\n  const res = await props.server.getFile(getCurrentPath())\n  files.value = res.sort(sortFiles)\n}\n\nfunction sortFiles(a, b) {\n  if (a.isFile && !b.isFile) return 1\n  if (!a.isFile && b.isFile) return -1\n  if (a.name.toLowerCase() < b.name.toLowerCase()) return -1\n  return 1\n}\n\nfunction getCurrentPath() {\n  return currentPath.value.map(e => e.name).join('/')\n}\n\nasync function openFile(f, overrideWarn = false) {\n  if (f.isFile) {\n    if (!skipDownload(f) && !overrideWarn && f.size > 30 * Math.pow(2, 20)) {\n      fileSizeWarnSubject.value = f\n      fileSizeWarn.value = true\n      return\n    }\n\n    fileSizeWarn.value = false\n    loading.value = true\n    const path = getCurrentPath() + `/${f.name}`\n    const content = skipDownload(f) ? null : await props.server.getFile(path, true)\n    file.value = { ...f, content, url: props.server.getFileUrl(path) }\n    editorOpen.value = true\n    loading.value = false\n  } else {\n    let path = ''\n    if (f.name === '..') {\n      currentPath.value.pop()\n      path = getCurrentPath()\n    } else {\n      path = getCurrentPath() + `/${f.name}`\n    }\n    const res = await props.server.getFile(path)\n    files.value = res.sort(sortFiles)\n    if (f.name !== '..') currentPath.value.push(f)\n  }\n}\n\nasync function saveFile() {\n  await props.server.uploadFile(`${getCurrentPath()}/${file.value.name}`, file.value.content)\n  editorOpen.value = false\n  file.value = null\n  refresh()\n}\n\nfunction getIcon(file) {\n  if (!file.isFile) return 'folder'\n  if (!file.extension) return 'file'\n  return 'file-' + file.extension.substring(1)\n}\n\nfunction deleteFile(file) {\n  events.emit(\n    'confirm',\n    t('files.ConfirmDelete', { name: file.name }),\n    {\n      text: t('files.Delete'),\n      icon: 'remove',\n      color: 'error',\n      action: async () => {\n        await props.server.deleteFile(getCurrentPath() + '/' + file.name)\n        await refresh()\n      }\n    },\n    {\n      color: 'primary'\n    }\n  )\n}\n\nconst numFormat = new Intl.NumberFormat('en-US', { maximumFractionDigits: 2 })\nfunction formatFileSize(size) {\n  if (!size) return '0 B'\n  if (size < Math.pow(2, 10)) return numFormat.format(size) + ' B'\n  if (size < Math.pow(2, 20)) return numFormat.format(size / Math.pow(2, 10)) + ' KiB'\n  if (size < Math.pow(2, 30)) return numFormat.format(size / Math.pow(2, 20)) + ' MiB'\n  if (size < Math.pow(2, 40)) return numFormat.format(size / Math.pow(2, 30)) + ' GiB'\n  return numFormat.format(size / Math.pow(2, 40)) + ' TiB'\n}\n\nfunction startCreateFile() {\n  newItemName.value = ''\n  createFileOpen.value = true\n}\n\nfunction startCreateFolder() {\n  newItemName.value = ''\n  createFolderOpen.value = true\n}\n\nasync function createFile() {\n  if (!newItemName.value || newItemName.value.trim() === '') return\n  await props.server.uploadFile(`${getCurrentPath()}/${newItemName.value}`, '')\n  const file = { name: newItemName.value, size: 0, isFile: true }\n  createFileOpen.value = false\n  newItemName.value = ''\n  await openFile(file)\n  await refresh()\n}\n\nasync function createFolder() {\n  if (!newItemName.value || newItemName.value.trim() === '') return\n  await props.server.createFolder(`${getCurrentPath()}/${newItemName.value}`)\n  const folder = { name: newItemName.value, isFile: false }\n  createFolderOpen.value = false\n  newItemName.value = ''\n  await openFile(folder)\n  await refresh()\n}\n\nconst archiveExtensions = [\n  '.7z',\n  '.bz2',\n  '.gz',\n  '.lz',\n  '.lzma',\n  '.rar',\n  '.tar',\n  '.tgz',\n  '.xz',\n  '.zip',\n  '.zipx'\n]\n\nfunction isArchive (file) {\n  const filename = file.name.toLowerCase()\n  for (let i = 0; i < archiveExtensions.length; i++) {\n    if (filename.endsWith(archiveExtensions[i])) return true\n  }\n  return false\n}\n\nasync function extract(file) {\n  loading.value = true\n  try {\n    let dest = getCurrentPath()\n    if (!dest.startsWith('/')) dest = '/' + dest\n    await props.server.extractFile(`${getCurrentPath()}/${file.name}`, dest)\n    refresh()\n  } finally {\n    loading.value = false\n  }\n}\n\nasync function makeArchiveName(fileName) {\n  let destination = `${getCurrentPath()}/${fileName}.zip`\n  for (let i = 2; await props.server.fileExists(destination); i++) {\n    destination = `${getCurrentPath()}/${fileName} (${i}).zip`\n  }\n  return destination\n}\n\nasync function archiveCurrentDirectory() {\n  loading.value = true\n  try {\n    const item = currentPath.value[currentPath.value.length - 1];\n    let lastPathEntry = props.server.id\n    if (item !== undefined) {\n      lastPathEntry = currentPath.value[currentPath.value.length - 1].name\n    }\n\n    await props.server.archiveFile(\n      await makeArchiveName(lastPathEntry),\n      `${getCurrentPath()}`\n    )\n  } finally {\n    setTimeout(() => {\n      refresh()\n      loading.value = false\n    }, 500)\n  }\n}\n\nasync function archive(file) {\n  loading.value = true\n  try {\n    await props.server.archiveFile(\n      await makeArchiveName(file.name),\n      `${getCurrentPath()}/${file.name}`\n    )\n  } finally {\n    setTimeout(() => {\n      refresh()\n      loading.value = false\n    }, 500)\n  }\n}\n\nfunction downloadLink(file) {\n  return props.server.getFileUrl(getCurrentPath() + '/' + file.name)\n}\n\nfunction fileListHotkey() {\n  if (fileEls.value[0]) fileEls.value[0].focus()\n}\n\nfunction trackFileEl(index) {\n  return (el) => fileEls.value[index] = el\n}\n</script>\n\n<template>\n  <div class=\"file-manager\">\n    <div class=\"header\">\n      <h2 v-text=\"t('servers.Files')\" />\n      <h3 v-text=\"'/' + getCurrentPath()\" />\n      <span class=\"spacer\" />\n      <btn v-if=\"canEdit\" v-hotkey=\"'f a'\" variant=\"icon\" :tooltip=\"t('files.ArchiveCurrent')\" @click=\"archiveCurrentDirectory()\"><icon name=\"archive\" /></btn>\n      <upload v-if=\"canEdit\" :path=\"getCurrentPath()\" :server=\"server\" hotkey=\"f u\" @uploaded=\"refresh()\" />\n      <upload v-if=\"canEdit && allowDirectoryUpload\" :path=\"getCurrentPath()\" :server=\"server\" folder hotkey=\"f d\" @uploaded=\"refresh()\" />\n      <btn v-if=\"canEdit\" v-hotkey=\"'f c f'\" variant=\"icon\" :tooltip=\"t('files.CreateFile')\" @click=\"startCreateFile()\"><icon name=\"file-create\" /></btn>\n      <btn v-if=\"canEdit\" v-hotkey=\"'f c d'\" variant=\"icon\" :tooltip=\"t('files.CreateFolder')\" @click=\"startCreateFolder()\"><icon name=\"folder-create\" /></btn>\n      <btn v-hotkey=\"'f r'\" variant=\"icon\" :tooltip=\"t('files.Refresh')\" @click=\"refresh(true)\"><icon name=\"reload\" /></btn>\n    </div>\n    <div v-hotkey=\"'f l'\" class=\"file-list\" @hotkey=\"fileListHotkey\">\n      <loader v-if=\"!Array.isArray(files)\" />\n      <!-- eslint-disable-next-line vue/no-template-shadow -->\n      <a v-for=\"(file, index) in files\" v-else :key=\"file.name\" :ref=\"trackFileEl(index)\" tabindex=\"0\" class=\"file\" @click=\"openFile(file)\" @keydown.enter=\"openFile(file)\">\n        <icon class=\"file-icon\" :name=\"getIcon(file)\" />\n        <div class=\"details\">\n          <div class=\"name\">{{ file.name }}</div>\n          <div v-if=\"file.isFile\" class=\"size\">{{ formatFileSize(file.size) }}</div>\n        </div>\n        <btn v-if=\"canEdit && file.name !== '..' && !file.isFile\" tabindex=\"-1\" variant=\"icon\" :tooltip=\"t('files.Archive')\" @click.stop=\"archive(file)\">\n          <icon name=\"archive\" />\n        </btn>\n        <btn v-if=\"canEdit && file.isFile && isArchive(file)\" tabindex=\"-1\" variant=\"icon\" :tooltip=\"t('files.Extract')\" @click.stop=\"extract(file)\">\n          <icon name=\"extract\" />\n        </btn>\n        <a v-if=\"file.isFile\" tabindex=\"-1\" class=\"dl-link\" :href=\"downloadLink(file)\" target=\"_blank\" rel=\"noopener\">\n          <btn tabindex=\"-1\" variant=\"icon\" :tooltip=\"t('files.Download')\" @click.stop=\"\">\n            <icon name=\"download\" />\n          </btn>\n        </a>\n        <btn v-if=\"canEdit && file.name !== '..'\" tabindex=\"-1\" variant=\"icon\" :tooltip=\"t('files.Delete')\" @click.stop=\"deleteFile(file)\">\n          <icon name=\"remove\" />\n        </btn>\n      </a>\n    </div>\n    <overlay v-model=\"fileSizeWarn\" closable :title=\"t('files.OpenLargeFile')\">\n      <btn color=\"error\" @click=\"fileSizeWarn = false\"><icon name=\"close\" />{{ t('common.Cancel') }}</btn>\n      <btn color=\"primary\" @click=\"openFile(fileSizeWarnSubject, true)\"><icon name=\"check\" />{{ t('files.OpenAnyways') }}</btn>\n    </overlay>\n    <overlay v-model=\"createFileOpen\" closable :title=\"t('files.CreateFile')\">\n      <text-field v-model=\"newItemName\" />\n      <btn color=\"primary\" :disabled=\"!newItemName || newItemName.trim() === ''\" @click=\"createFile()\"><icon name=\"check\" />{{ t('files.CreateFile') }}</btn>\n    </overlay>\n    <overlay v-model=\"createFolderOpen\" closable :title=\"t('files.CreateFolder')\">\n      <text-field v-model=\"newItemName\" />\n      <btn color=\"primary\" :disabled=\"!newItemName || newItemName.trim() === ''\" @click=\"createFolder()\"><icon name=\"check\" />{{ t('files.CreateFolder') }}</btn>\n    </overlay>\n    <overlay v-model=\"loading\" class=\"loader-overlay\">\n      <loader />\n    </overlay>\n    <overlay v-model=\"editorOpen\" class=\"editor\">\n      <editor v-if=\"file\" v-model=\"file\" :read-only=\"!canEdit\" @save=\"saveFile()\" @close=\"editorOpen = false\" />\n    </overlay>\n  </div>\n</template>\n"],"names":["Ace","Btn","Icon","_createElementBlock"],"mappings":"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"}