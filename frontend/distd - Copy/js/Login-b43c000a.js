import{l as L,k as g,H as S,r as a,o as y,h as U,q as E,t as f,s as n,C as s,A as j,x as P,I as q,B as K}from"./vendor-943aface.js";import{_ as C,a as V,b as M,d as T}from"./index-b96ce60d.js";const A={class:"login"},D=["textContent"],F={setup(H){const{t:o}=L(),p=g("api"),B=g("events"),w=g("validate"),c=S(),r=a(""),u=a(!1),i=a(""),d=a(!1),m=a(!1),v=a("");function x(){try{c.push(JSON.parse(sessionStorage.getItem("returnTo"))),sessionStorage.removeItem("returnTo")}catch{c.push(T(p))}B.emit("login")}async function $(){const l=await p.auth.login(r.value,i.value);l===!0?x():l==="otp"&&(m.value=!0)}function I(){m.value=!1,v.value=""}async function N(){await p.auth.loginOtp(v.value),x()}function b(l=!1){if(w.email(r.value))u.value=!1;else{if(l===!0)return;u.value=!0}}function O(){if(u.value)return o("errors.ErrEmailInvalid")}function k(l=!1){if(w.password(i.value))d.value=!1;else{if(l===!0)return;d.value=!0}}function R(){if(d.value)return o("errors.ErrPasswordRequirements")}return(l,e)=>(y(),U("div",A,[E("h1",{textContent:f(n(o)("users.Login"))},null,8,D),E("form",{onKeydown:e[6]||(e[6]=q(t=>$(),["enter"]))},[s(C,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"email",name:"email",label:n(o)("users.Email"),error:O(),icon:"email",autofocus:"",onBlur:b,onChange:e[1]||(e[1]=t=>b(!0))},null,8,["modelValue","label","error"]),s(C,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),type:"password",name:"password",label:n(o)("users.Password"),error:R(),icon:"lock",onBlur:k,onChange:e[3]||(e[3]=t=>k(!0))},null,8,["modelValue","label","error"]),s(V,{color:"primary",disabled:u.value||d.value,onClick:e[4]||(e[4]=t=>$()),textContent:f(n(o)("users.Login"))},null,8,["disabled","textContent"]),l.$config.registrationEnabled?(y(),j(V,{key:0,variant:"text",onClick:e[5]||(e[5]=t=>l.$router.push({name:"Register"})),textContent:f(n(o)("users.RegisterLink"))},null,8,["textContent"])):P("",!0)],32),s(M,{modelValue:m.value,"onUpdate:modelValue":e[9]||(e[9]=t=>m.value=t),title:n(o)("users.OtpNeeded"),closable:"",onClose:e[10]||(e[10]=t=>I())},{default:K(()=>[s(C,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=t=>v.value=t),autofocus:""},null,8,["modelValue"]),s(V,{color:"primary",onClick:e[8]||(e[8]=t=>N()),textContent:f(n(o)("users.Login"))},null,8,["textContent"])]),_:1},8,["modelValue","title"])]))}};export{F as default};
//# sourceMappingURL=Login-b43c000a.js.map
