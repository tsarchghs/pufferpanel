{"version":3,"file":"generic-7763e5fd.js","sources":["../../src/components/server/Status.vue","../../src/components/server/Controls.vue","../../src/components/server/Header.vue","../../src/components/serverTypes/generic.vue"],"sourcesContent":["<script setup>\nimport { ref, onMounted, onUnmounted } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\n\nconst status = ref(null)\n\nconst props = defineProps({\n  server: { type: Object, required: true }\n})\n\nlet unbindEvent = null\nlet task = null\nonMounted(async () => {\n  unbindEvent = props.server.on('status', e => {\n    if (e.installing) {\n      status.value = 'installing'\n    } else if (e.running) {\n      status.value = 'online'\n    } else {\n      status.value = 'offline'\n    }\n  })\n\n  task = props.server.startTask(async () => {\n    if (props.server.needsPolling() && props.server.hasScope('server.status')) {\n      status.value = await props.server.getStatus()\n    }\n  }, 5000)\n\n  if (props.server.hasScope('server.status'))\n    status.value = await props.server.getStatus()\n})\n\nonUnmounted(() => {\n  if (unbindEvent) unbindEvent()\n  if (task) props.server.stopTask(task)\n})\n</script>\n\n<template>\n  <span\n    v-if=\"server.hasScope('server.status')\"\n    :class=\"['status', status]\"\n  >\n    <span\n      class=\"tooltip\"\n      :data-tooltip=\"t(status === 'online' ? 'common.Online' : status === 'offline' ? 'common.Offline' : status === 'installing' ? 'common.Installing' : 'common.Unknown')\"\n    />\n  </span>\n</template>\n","<script setup>\nimport { ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\n\nconst { t } = useI18n()\n\nconst menuOpen = ref(false)\n\nfunction hideMenu() {\n  if (!menuOpen.value) return\n  menuOpen.value = false\n}\n\nfunction toggleMenu() {\n  const state = menuOpen.value\n  setTimeout(() => menuOpen.value = !state, 100)\n}\n\nconst props = defineProps({\n  server: { type: Object, required: true }\n})\n\nconst hotkeys = {\n  'r r': () => props.server.start(),\n  'r s': () => props.server.stop(),\n  'r k': () => props.server.kill(),\n  'r i': () => props.server.install()\n}\n\nfunction onHotkey(keys) {\n  if (hotkeys[keys]) hotkeys[keys]()\n}\n\nconst showMenu =\n  props.server.hasScope('server.start') || \n  props.server.hasScope('server.stop') || \n  props.server.hasScope('server.kill') || \n  props.server.hasScope('server.install')\n</script>\n\n<template>\n  <span v-hotkey=\"Object.keys(hotkeys)\" class=\"server-controls\" @hotkey=\"onHotkey\">\n    <btn v-if=\"server.hasScope('server.start')\" class=\"start\" @click=\"server.start()\">\n      <icon name=\"play\" />\n      <span class=\"text\">{{ t('servers.Start') }}</span>\n    </btn>\n    <btn v-if=\"server.hasScope('server.stop')\" class=\"stop\" @click=\"server.stop()\">\n      <icon name=\"stop\" />\n      <span class=\"text\">{{ t('servers.Stop') }}</span>\n    </btn>\n    <btn v-if=\"server.hasScope('server.kill')\" class=\"kill\" @click=\"server.kill()\">\n      <icon name=\"kill\" />\n      <span class=\"text\">{{ t('servers.Kill') }}</span>\n    </btn>\n    <btn v-if=\"server.hasScope('server.install')\" class=\"install\" @click=\"server.install()\">\n      <icon name=\"install\" />\n      <span class=\"text\">{{ t('servers.Install') }}</span>\n    </btn>\n    <btn class=\"menu\" @click=\"toggleMenu()\">\n      <icon name=\"menu\" />\n    </btn>\n    <div v-if=\"showMenu\" v-click-outside=\"hideMenu\" :class=\"['menu', menuOpen ? 'open' : 'closed']\">\n      <btn v-if=\"server.hasScope('server.start')\" class=\"start\" @click=\"menuOpen = false; server.start()\">\n        <icon name=\"play\" />\n        <span class=\"text\">{{ t('servers.Start') }}</span>\n      </btn>\n      <btn v-if=\"server.hasScope('server.stop')\" class=\"stop\" @click=\"menuOpen = false; server.stop()\">\n        <icon name=\"stop\" />\n        <span class=\"text\">{{ t('servers.Stop') }}</span>\n      </btn>\n      <btn v-if=\"server.hasScope('server.kill')\" class=\"kill\" @click=\"menuOpen = false; server.kill()\">\n        <icon name=\"kill\" />\n        <span class=\"text\">{{ t('servers.Kill') }}</span>\n      </btn>\n      <btn v-if=\"server.hasScope('server.install')\" class=\"install\" @click=\"menuOpen = false; server.install()\">\n        <icon name=\"install\" />\n        <span class=\"text\">{{ t('servers.Install') }}</span>\n      </btn>\n    </div>\n  </span>\n</template>\n","<script setup>\nimport { ref } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\nimport Overlay from '@/components/ui/Overlay.vue'\nimport TextField from '@/components/ui/TextField.vue'\nimport Status from './Status.vue'\nimport Controls from './Controls.vue'\n\nconst props = defineProps({\n  server: { type: Object, required: true }\n})\n\nconst { t } = useI18n()\nconst edit = ref(false)\nconst name = ref(props.server.name)\n\nasync function updateName() {\n  await props.server.updateName(name.value)\n  edit.value = false\n}\n</script>\n\n<template>\n  <h1 class=\"server-header\">\n    <Status :server=\"server\" />\n    <span class=\"name\">\n      {{ server.name }}\n      <btn v-if=\"server.hasScope('server.name.edit')\" variant=\"icon\" :tooltip=\"t('servers.EditName')\" @click=\"edit = !edit\"><icon name=\"edit\" /></btn>\n    </span>\n    <controls :server=\"server\" />\n  </h1>\n  <overlay v-model=\"edit\" :title=\"t('servers.EditName')\" closable class=\"server-name\">\n    <text-field v-model=\"name\" />\n    <btn color=\"primary\" @click=\"updateName()\"><icon name=\"save\" />{{ t('common.Save') }}</btn>\n  </overlay>\n</template>\n","<script setup>\nimport { ref, defineAsyncComponent, inject, onMounted, onUnmounted } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useI18n } from 'vue-i18n'\n\nimport ServerHeader from '../server/Header.vue'\n\nimport Btn from '@/components/ui/Btn.vue'\nimport Icon from '@/components/ui/Icon.vue'\nimport Loader from '@/components/ui/Loader.vue'\nimport Tab from '@/components/ui/Tab.vue'\nimport Tabs from '@/components/ui/Tabs.vue'\n\nconst Console = defineAsyncComponent({\n  loader: () => import('../server/Console.vue'),\n  loadingComponent: Loader\n})\nconst Stats = defineAsyncComponent({\n  loader: () => import('../server/Stats.vue'),\n  loadingComponent: Loader\n})\nconst Files = defineAsyncComponent({\n  loader: () => import('../server/Files.vue'),\n  loadingComponent: Loader\n})\nconst Settings = defineAsyncComponent({\n  loader: () => import('../server/Settings.vue'),\n  loadingComponent: Loader\n})\nconst Users = defineAsyncComponent({\n  loader: () => import('../server/Users.vue'),\n  loadingComponent: Loader\n})\nconst Tasks = defineAsyncComponent({\n  loader: () => import('../server/Tasks.vue'),\n  loadingComponent: Loader\n})\nconst Sftp = defineAsyncComponent({\n  loader: () => import('../server/Sftp.vue'),\n  loadingComponent: Loader\n})\nconst Admin = defineAsyncComponent({\n  loader: () => import('../server/Admin.vue'),\n  loadingComponent: Loader\n})\n\nconst { t } = useI18n()\nconst events = inject('events')\nconst route = useRoute()\nconst router = useRouter()\nconst http = ref(false)\nconst httpWarnDismissed = ref(false)\nlet httpCount = 2\n\nconst props = defineProps({\n  server: { type: Object, required: true }\n})\n\nlet task = null\nonMounted(() => {\n  if (route.query.created && props.server.hasScope('server.install')) {\n    events.emit(\n      'confirm',\n      {\n        title: t('servers.InstallPrompt'),\n        body: t('servers.InstallPromptBody'),\n      },\n      {\n        text: t('servers.Install'),\n        icon: 'install',\n        action: () => {\n          props.server.install()\n        }\n      },\n      {\n        color: 'neutral'\n      }\n    )\n    router.push({query: {}, hash: route.hash})\n  }\n\n  task = props.server.startTask(() => {\n    // prevent the info alert from flickering on and off too much when dealing with a wonky connection\n    if (props.server.needsPolling() && httpCount < 3) httpCount += 1\n    if (!props.server.needsPolling() && httpCount > 0) httpCount -= 1\n    if (httpCount === 3) http.value = true\n    if (httpCount === 0) http.value = false\n  }, 5000)\n})\n\nonUnmounted(() => {\n  if (task) props.server.stopTask(task)\n})\n</script>\n\n<template>\n  <div :class=\"http ? 'http-fallback' : ''\">\n    <server-header :key=\"nameUpdateHack\" :server=\"server\" />\n\n    <tabs anchors>\n      <tab\n        v-if=\"server.hasScope('server.console') || server.hasScope('server.console.send')\"\n        id=\"console\"\n        :title=\"t('servers.Console')\"\n        icon=\"console\"\n        hotkey=\"t c\"\n      >\n        <div v-if=\"http && !httpWarnDismissed\" class=\"alert info\">\n          <span v-text=\"t('servers.SocketWarnConsole')\" />\n          <btn variant=\"icon\" @click=\"httpWarnDismissed = true\"><icon name=\"close\"></icon></btn>\n        </div>\n        <Console :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.stats')\"\n        id=\"stats\"\n        :title=\"t('servers.Statistics')\"\n        icon=\"stats\"\n        hotkey=\"t i\"\n      >\n        <stats :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.files.view')\"\n        id=\"files\"\n        :title=\"t('servers.Files')\"\n        icon=\"files\"\n        hotkey=\"t f\"\n      >\n        <files :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.data.view') || server.hasScope('server.flags.view')\"\n        id=\"settings\"\n        :title=\"t('servers.Settings')\"\n        icon=\"settings\"\n        hotkey=\"t s\"\n      >\n        <settings :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.users.view')\"\n        id=\"users\"\n        :title=\"t('users.Users')\"\n        icon=\"users\"\n        hotkey=\"t u\"\n      >\n        <users :server=\"server\" />\n      </tab>\n      <!-- currently disabled due to tasks being broken -->\n      <tab\n        v-if=\"false && server.hasScope('server.tasks.view')\"\n        id=\"tasks\"\n        :title=\"t('servers.Tasks')\"\n        icon=\"tasks\"\n        hotkey=\"t t\"\n      >\n        <tasks :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.sftp')\"\n        id=\"sftp\"\n        :title=\"t('servers.SFTPInfo')\"\n        icon=\"sftp\"\n        hotkey=\"t 6\"\n      >\n        <sftp :server=\"server\" />\n      </tab>\n      <tab\n        v-if=\"server.hasScope('server.definition.view') || server.hasScope('server.delete')\"\n        id=\"admin\"\n        :title=\"t('servers.Admin')\"\n        icon=\"admin\"\n        hotkey=\"t a\"\n      >\n        <admin :server=\"server\" />\n      </tab>\n    </tabs>\n  </div>\n</template>\n"],"names":["Loader"],"mappings":"mYAIM,CAAE,KAAM,IAER,EAAS,EAAI,MAMnB,GAAI,GAAc,KACd,EAAO,KACX,SAAU,SAAY,CACpB,EAAc,EAAM,OAAO,GAAG,SAAU,GAAK,CAC3C,AAAI,EAAE,WACJ,EAAO,MAAQ,aACV,AAAI,EAAE,QACX,EAAO,MAAQ,SAEf,EAAO,MAAQ,YAInB,EAAO,EAAM,OAAO,UAAU,SAAY,CACxC,AAAI,EAAM,OAAO,gBAAkB,EAAM,OAAO,SAAS,kBACvD,GAAO,MAAQ,KAAM,GAAM,OAAO,cAEnC,KAEC,EAAM,OAAO,SAAS,kBACxB,GAAO,MAAQ,KAAM,GAAM,OAAO,eAGtC,EAAY,IAAM,CAChB,AAAI,GAAa,IACb,GAAM,EAAM,OAAO,SAAS,6fC/B5B,CAAE,KAAM,IAER,EAAW,EAAI,IAErB,YAAoB,CAClB,AAAI,CAAC,EAAS,OACd,GAAS,MAAQ,IAGnB,YAAsB,CACpB,KAAM,GAAQ,EAAS,MACvB,WAAW,IAAM,EAAS,MAAQ,CAAC,EAAO,KAO5C,KAAM,GAAU,CACd,MAAO,IAAM,EAAM,OAAO,QAC1B,MAAO,IAAM,EAAM,OAAO,OAC1B,MAAO,IAAM,EAAM,OAAO,OAC1B,MAAO,IAAM,EAAM,OAAO,WAG5B,WAAkB,EAAM,CACtB,AAAI,EAAQ,IAAO,EAAQ,KAG7B,KAAM,GACJ,EAAM,OAAO,SAAS,iBACtB,EAAM,OAAO,SAAS,gBACtB,EAAM,OAAO,SAAS,gBACtB,EAAM,OAAO,SAAS,0jECzBlB,CAAE,KAAM,IACR,EAAO,EAAI,IACX,EAAO,EAAI,EAAM,OAAO,MAE9B,kBAA4B,CAC1B,KAAM,GAAM,OAAO,WAAW,EAAK,OACnC,EAAK,MAAQ,s4BCPT,EAAU,EAAqB,CACnC,OAAQ,IAAM,0DACd,iBAAkBA,IAEd,EAAQ,EAAqB,CACjC,OAAQ,IAAM,wDACd,iBAAkBA,IAEd,EAAQ,EAAqB,CACjC,OAAQ,IAAM,wDACd,iBAAkBA,IAEd,EAAW,EAAqB,CACpC,OAAQ,IAAM,2DACd,iBAAkBA,IAEd,EAAQ,EAAqB,CACjC,OAAQ,IAAM,wDACd,iBAAkBA,IAEN,EAAqB,CACjC,OAAQ,IAAM,wDACd,iBAAkBA,IAEpB,KAAM,GAAO,EAAqB,CAChC,OAAQ,IAAM,uDACd,iBAAkBA,IAEd,EAAQ,EAAqB,CACjC,OAAQ,IAAM,wDACd,iBAAkBA,IAGd,CAAE,KAAM,IACR,EAAS,EAAO,UAChB,EAAQ,IACR,EAAS,IACT,EAAO,EAAI,IACX,EAAoB,EAAI,IAC9B,GAAI,GAAY,EAMZ,EAAO,KACX,SAAU,IAAM,CACd,AAAI,EAAM,MAAM,SAAW,EAAM,OAAO,SAAS,mBAC/C,GAAO,KACL,UACA,CACE,MAAO,EAAE,yBACT,KAAM,EAAE,8BAEV,CACE,KAAM,EAAE,mBACR,KAAM,UACN,OAAQ,IAAM,CACZ,EAAM,OAAO,YAGjB,CACE,MAAO,YAGX,EAAO,KAAK,CAAC,MAAO,GAAI,KAAM,EAAM,QAGtC,EAAO,EAAM,OAAO,UAAU,IAAM,CAElC,AAAI,EAAM,OAAO,gBAAkB,EAAY,GAAG,IAAa,GAC3D,CAAC,EAAM,OAAO,gBAAkB,EAAY,GAAG,IAAa,GAC5D,IAAc,GAAG,GAAK,MAAQ,IAC9B,IAAc,GAAG,GAAK,MAAQ,KACjC,OAGL,EAAY,IAAM,CAChB,AAAI,GAAM,EAAM,OAAO,SAAS"}