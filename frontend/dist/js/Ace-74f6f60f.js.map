{"version":3,"file":"Ace-74f6f60f.js","sources":["../../src/components/ui/Ace.vue"],"sourcesContent":["<script setup>\nimport { ref, onMounted, onUnmounted, onUpdated, nextTick } from 'vue'\n\nconst props = defineProps({\n  id: { type: String, default: () => 'editor' },\n  file: { type: String, default: () => undefined },\n  mode: { type: String, default: () => undefined },\n  readOnly: { type: Boolean, default: () => false },\n  modelValue: { type: String, required: true }\n})\n\nconst emit = defineEmits(['update:modelValue'])\n\nconst el = ref(null)\n\nlet editor = null\n\nonMounted(() => {\n  if (!window.ace) {\n    const ace = document.createElement('script')\n    ace.src = '/js/ace/ace.js'\n    ace.type = 'text/javascript'\n\n    ace.onload = () => {\n      const ml = document.createElement('script')\n      ml.src = '/js/ace/ext-modelist.js'\n      ml.type = 'text/javascript'\n\n      ml.onload = () => {\n        init()\n      }\n\n      document.head.append(ml)\n    }\n\n    document.head.append(ace)\n  } else {\n    init()\n  }\n})\n\nonUnmounted(() => {\n  if (editor) editor.destroy()\n})\n\nonUpdated(() => {\n  if (editor && editor.session.getValue() !== props.modelValue)\n    editor.session.setValue(props.modelValue)\n  if (editor) {\n    editor.setReadOnly(props.readOnly)\n  }\n})\n\nfunction init() {\n  nextTick(() => {\n    editor = window.ace.edit(props.id)\n    let theme = getComputedStyle(el.value).getPropertyValue('--ace-theme').trim() || 'monokai'\n    editor.setTheme(`ace/theme/${theme}`)\n    if (props.mode) {\n      editor.session.setMode(`ace/mode/${props.mode}`)\n    } else if (props.file) {\n      const modelist = window.ace.require('ace/ext/modelist')\n      const mode = modelist.getModeForPath(props.file).mode\n      editor.session.setMode(mode)\n    }\n    editor.session.setValue(props.modelValue)\n    editor.setReadOnly(props.readOnly)\n    editor.on('change', () => {\n      emit('update:modelValue', editor.session.getValue())\n    })\n    editor.focus()\n    editor.commands.addCommand({\n      name: 'unfocusEditor',\n      bindKey: { win: 'Escape', mac: 'Escape' },\n      exec: (editor) => {\n        editor.blur()\n      }\n    })\n  })\n}\n\ndefineExpose({\n  refresh: () => {\n    editor.resize()\n  }\n})\n</script>\n\n<template>\n  <div :id=\"id\" ref=\"el\" v-hotkey class=\"ace\" />\n</template>\n"],"names":[],"mappings":"6WAaM,EAAK,EAAI,MAEf,GAAI,GAAS,KAEb,EAAU,IAAM,CACd,GAAK,OAAO,IAmBV,QAnBe,CACf,KAAM,GAAM,SAAS,cAAc,UACnC,EAAI,IAAM,iBACV,EAAI,KAAO,kBAEX,EAAI,OAAS,IAAM,CACjB,KAAM,GAAK,SAAS,cAAc,UAClC,EAAG,IAAM,0BACT,EAAG,KAAO,kBAEV,EAAG,OAAS,IAAM,CAChB,KAGF,SAAS,KAAK,OAAO,IAGvB,SAAS,KAAK,OAAO,MAMzB,EAAY,IAAM,CAChB,AAAI,GAAQ,EAAO,YAGrB,EAAU,IAAM,CACd,AAAI,GAAU,EAAO,QAAQ,aAAe,EAAM,YAChD,EAAO,QAAQ,SAAS,EAAM,YAC5B,GACF,EAAO,YAAY,EAAM,YAI7B,YAAgB,CACd,EAAS,IAAM,CACb,EAAS,OAAO,IAAI,KAAK,EAAM,IAC/B,GAAI,GAAQ,iBAAiB,EAAG,OAAO,iBAAiB,eAAe,QAAU,UAEjF,GADA,EAAO,SAAS,aAAa,KACzB,EAAM,KACR,EAAO,QAAQ,QAAQ,YAAY,EAAM,gBAChC,EAAM,KAAM,CAErB,KAAM,GAAO,AADI,OAAO,IAAI,QAAQ,oBACd,eAAe,EAAM,MAAM,KACjD,EAAO,QAAQ,QAAQ,GAEzB,EAAO,QAAQ,SAAS,EAAM,YAC9B,EAAO,YAAY,EAAM,UACzB,EAAO,GAAG,SAAU,IAAM,CACxB,EAAK,oBAAqB,EAAO,QAAQ,cAE3C,EAAO,QACP,EAAO,SAAS,WAAW,CACzB,KAAM,gBACN,QAAS,CAAE,IAAK,SAAU,IAAK,UAC/B,KAAM,AAAC,GAAW,CAChB,EAAO,YAMf,SAAa,CACX,QAAS,IAAM,CACb,EAAO"}