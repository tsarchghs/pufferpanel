{"version":3,"file":"Invite-d1c5c962.js","sources":["../../src/views/Invite.vue"],"sourcesContent":["<script setup>\nimport { ref, inject } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\nimport { useI18n } from 'vue-i18n'\nimport TextField from '@/components/ui/TextField.vue'\nimport Btn from '@/components/ui/Btn.vue'\nimport defaultRoute from '@/router/defaultRoute'\n\nconst { t } = useI18n()\nconst api = inject('api')\nconst events = inject('events')\nconst validate = inject('validate')\nconst router = useRouter()\nconst route = useRoute()\n\nconst username = ref('')\nconst email = ref(route.query.email)\nconst password = ref('')\nconst confirmPassword = ref('')\n\nconst errorUsername = ref('')\nconst errorEmail = ref('')\nconst errorPassword = ref('')\nconst errorConfirmPassword = ref('')\n\nfunction isValidConfirmPassword() {\n  return confirmPassword.value === password.value\n}\n\nfunction checkUsername() {\n  if (!validate.username(username.value)) errorUsername.value = t('errors.ErrUsernameRequirements')\n}\n\nfunction checkEmail() {\n  if (!validate.email(email.value)) errorEmail.value = t('errors.ErrEmailInvalid')\n}\n\nfunction checkPassword() {\n  if (!validate.password(password.value)) errorPassword.value = t('errors.ErrPasswordRequirements')\n}\n\nfunction checkConfirmPassword() {\n  if (!isValidConfirmPassword()) errorConfirmPassword.value = t('errors.ErrPasswordsNotIdentical')\n}\n\nfunction canSubmit() {\n  return validate.username(username.value) &&\n    validate.email(email.value) &&\n    validate.password(password.value) &&\n    isValidConfirmPassword()\n}\n\nasync function register() {\n  if (!canSubmit()) return\n\n  await api.auth.login(email.value, route.query.token)\n  await api.self.updateDetails(username.value, email.value, route.query.token)\n  await api.self.changePassword(route.query.token, password.value)\n  router.push(defaultRoute(api))\n  events.emit('login')\n}\n</script>\n\n<template>\n  <div class=\"register\">\n    <h1 v-text=\"t('users.Register')\" />\n    <text-field\n      v-model=\"username\"\n      autofocus\n      :label=\"t('users.Username')\"\n      icon=\"account\"\n      :error=\"errorUsername\"\n      @change=\"errorUsername = ''\"\n      @blur=\"checkUsername()\"\n    />\n    <text-field\n      v-model=\"email\"\n      disabled\n      type=\"email\"\n      :label=\"t('users.Email')\"\n      icon=\"email\"\n      :error=\"errorEmail\"\n      @change=\"errorEmail = ''\"\n      @blur=\"checkEmail()\"\n    />\n    <text-field\n      v-model=\"password\"\n      type=\"password\"\n      :label=\"t('users.Password')\"\n      icon=\"lock\"\n      :error=\"errorPassword\"\n      @change=\"errorPassword = ''\"\n      @blur=\"checkPassword()\"\n    />\n    <text-field\n      v-model=\"confirmPassword\"\n      type=\"password\"\n      :label=\"t('users.ConfirmPassword')\"\n      icon=\"lock\"\n      :error=\"errorConfirmPassword\"\n      @change=\"errorConfirmPassword = ''\"\n      @blur=\"checkConfirmPassword()\"\n    />\n    <btn color=\"primary\" :disabled=\"!canSubmit()\" @click=\"register()\" v-text=\"t('users.Register')\" />\n    <btn variant=\"text\" @click=\"$router.push({ name: 'Login' })\" v-text=\"t('users.LoginLink')\" />\n  </div>\n</template>\n"],"names":[],"mappings":"8NAQA,KAAM,CAAE,KAAM,IACR,EAAM,EAAO,OACb,EAAS,EAAO,UAChB,EAAW,EAAO,YAClB,EAAS,IACT,EAAQ,IAER,EAAW,EAAI,IACf,EAAQ,EAAI,EAAM,MAAM,OACxB,EAAW,EAAI,IACf,EAAkB,EAAI,IAEtB,EAAgB,EAAI,IACpB,EAAa,EAAI,IACjB,EAAgB,EAAI,IACpB,EAAuB,EAAI,IAEjC,YAAkC,CAChC,MAAO,GAAgB,QAAU,EAAS,MAG5C,YAAyB,CACvB,AAAK,EAAS,SAAS,EAAS,QAAQ,GAAc,MAAQ,EAAE,mCAGlE,YAAsB,CACpB,AAAK,EAAS,MAAM,EAAM,QAAQ,GAAW,MAAQ,EAAE,2BAGzD,YAAyB,CACvB,AAAK,EAAS,SAAS,EAAS,QAAQ,GAAc,MAAQ,EAAE,mCAGlE,YAAgC,CAC9B,AAAK,KAA0B,GAAqB,MAAQ,EAAE,oCAGhE,YAAqB,CACnB,MAAO,GAAS,SAAS,EAAS,QAChC,EAAS,MAAM,EAAM,QACrB,EAAS,SAAS,EAAS,QAC3B,IAGJ,kBAA0B,CACxB,AAAI,CAAC,KAEL,MAAM,GAAI,KAAK,MAAM,EAAM,MAAO,EAAM,MAAM,OAC9C,KAAM,GAAI,KAAK,cAAc,EAAS,MAAO,EAAM,MAAO,EAAM,MAAM,OACtE,KAAM,GAAI,KAAK,eAAe,EAAM,MAAM,MAAO,EAAS,OAC1D,EAAO,KAAK,EAAa,IACzB,EAAO,KAAK"}