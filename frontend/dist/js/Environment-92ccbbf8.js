import{k as h,l as T,r as d,K as j,o as k,h as U,C as o,s as n,q as x,F,v as A,t as J,B as C,P as K,N as D,A as L,x as M}from"./vendor-943aface.js";import{_ as I,e as O,a as B,b as P}from"./index-b96ce60d.js";import{D as z}from"./Dropdown-f05f24bf.js";import{_ as G}from"./EnvironmentConfig-793daa60.js";const ae={props:{idEditable:{type:Boolean,default:()=>!1},modelValue:{type:String,required:!0}},emits:["update:modelValue","valid"],setup(b,{emit:$}){const N=b,i=h("api"),{t:l}=T(),e=d(JSON.parse(N.modelValue));let p=null;const v=d(!1),f=d(!0),V=d(!1),c=d(!1);function E(){$("update:modelValue",JSON.stringify(e.value,void 0,4))}function S(){clearTimeout(p),p=setTimeout(async()=>{if(e.value.name&&e.value.name.trim()!==""){const m=await i.template.exists(0,e.value.name);f.value=!m}else f.value=!0;y()},500),E()}function g(){return v.value?l("templates.errors.NameInvalid"):f.value?null:l("templates.NameNotUnique")}function y(){v.value=!1,V.value=!1,c.value=!1,(!e.value.name||e.value.name.trim()==="")&&(v.value=!0),(!e.value.display||e.value.display.trim()==="")&&(V.value=!0),(!e.value.type||e.value.type.trim()==="")&&(c.value=!0),$("valid",!v.value&&!V.value&&!c.value)}return j(()=>{try{const m=JSON.parse(N.modelValue);let a=!1;m.name&&e.value.name&&e.value.name!==m.name&&(a=!0),JSON.stringify(e.value)!==JSON.stringify(m)&&(e.value=m,y(),a&&S())}catch{}}),(m,a)=>(k(),U("div",null,[o(I,{modelValue:e.value.name,"onUpdate:modelValue":[a[0]||(a[0]=r=>e.value.name=r),S],disabled:!b.idEditable,label:n(l)("common.Name"),hint:b.idEditable?n(l)("templates.description.Name"):void 0,error:g(),onBlur:a[1]||(a[1]=r=>y())},null,8,["modelValue","disabled","label","hint","error"]),o(I,{modelValue:e.value.display,"onUpdate:modelValue":[a[2]||(a[2]=r=>e.value.display=r),E],label:n(l)("templates.Display"),hint:n(l)("templates.description.Display"),error:V.value?n(l)("templates.errors.DisplayInvalid"):void 0,onBlur:a[3]||(a[3]=r=>y())},null,8,["modelValue","label","hint","error"]),o(I,{modelValue:e.value.type,"onUpdate:modelValue":[a[4]||(a[4]=r=>e.value.type=r),E],label:n(l)("templates.Type"),hint:n(l)("templates.description.Type"),error:c.value?n(l)("templates.errors.TypeInvalid"):void 0,onBlur:a[5]||(a[5]=r=>y())},null,8,["modelValue","label","hint","error"])]))}},H={class:"environments"},Q={class:"list"},R=["onClick"],W=["textContent"],X={class:"actions"},te={props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(b,{emit:$}){const N=b,{t:i}=T(),l=d(JSON.parse(N.modelValue)),e=d({}),p=d(!1),v=d(!1),f=d(0),V=[{value:"host",label:i("env.host.name")},{value:"docker",label:i("env.docker.name")}],c={host:{type:"host"},docker:{type:"docker",image:"pufferpanel/generic"}};function E(){$("update:modelValue",JSON.stringify(l.value,void 0,4))}function S(s){e.value=c[s]}j(()=>{try{const s=JSON.parse(N.modelValue);JSON.stringify(l.value)!==JSON.stringify(s)&&(l.value=s)}catch{}});function g(){return V.filter(s=>l.value.supportedEnvironments.filter(t=>t.type===s.value).length===0)}function y(){e.value=c[g()[0].value],v.value=!0,p.value=!0}function m(s){e.value=l.value.supportedEnvironments[s],f.value=s,p.value=!0}function a(){p.value=!1,v.value=!1,e.value={},f.value=0}function r(){v.value===!0?l.value.supportedEnvironments.push(e.value):l.value.supportedEnvironments[f.value]=e.value,a(),E()}function q(s){const t=l.value.supportedEnvironments[s];l.value.supportedEnvironments.splice(s,1),l.value.environment.type===t.type&&(l.value.environment=l.value.supportedEnvironments[0]),E()}return(s,t)=>(k(),U("div",H,[x("ul",Q,[(k(!0),U(F,null,A(l.value.supportedEnvironments,(u,_)=>(k(),U("li",{key:u.type,class:"list-item clickable"},[x("div",{class:"list-item-content",onClick:w=>m(_)},[x("span",{textContent:J(n(i)(`env.${u.type}.name`))},null,8,W),o(B,{disabled:l.value.supportedEnvironments.length<2,variant:"icon",onClick:K(w=>q(_),["stop"])},{default:C(()=>[o(O,{name:"remove"})]),_:2},1032,["disabled","onClick"])],8,R)]))),128))]),o(B,{disabled:g().length===0,variant:"text",onClick:t[0]||(t[0]=u=>y())},{default:C(()=>[o(O,{name:"plus"}),D(J(n(i)("templates.AddEnvironment")),1)]),_:1},8,["disabled"]),o(P,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=u=>p.value=u)},{default:C(()=>[v.value?(k(),L(z,{key:0,modelValue:e.value.type,"onUpdate:modelValue":[t[1]||(t[1]=u=>e.value.type=u),S],options:g(),label:n(i)("templates.Environment")},null,8,["modelValue","options","label"])):M("",!0),o(G,{modelValue:e.value,"onUpdate:modelValue":t[2]||(t[2]=u=>e.value=u),"no-fields-message":n(i)("env.NoEnvFields")},null,8,["modelValue","no-fields-message"]),x("div",X,[o(B,{color:"error",onClick:t[3]||(t[3]=u=>a())},{default:C(()=>[o(O,{name:"close"}),D(J(n(i)("common.Cancel")),1)]),_:1}),o(B,{color:"primary",onClick:t[4]||(t[4]=u=>r())},{default:C(()=>[o(O,{name:"check"}),D(J(n(i)("common.Confirm")),1)]),_:1})])]),_:1},8,["modelValue"])]))}};export{ae as _,te as a};
//# sourceMappingURL=Environment-92ccbbf8.js.map
