import{l as x,r as y,K as T,o as _,h as E,C as t,s as a,k as O,H as B,p as h,y as q,q as D,t as c,z as U,A as w,B as l,N as k,x as J}from"./vendor-943aface.js";import{_ as A}from"./Ace-74f6f60f.js";import{e as j,a as g,b as H}from"./index-b96ce60d.js";import{T as R,_ as p}from"./Tab-85f76cb0.js";import{_ as I,a as z,b as F,c as K}from"./RunConfig-a666fd53.js";import{_ as L}from"./EnvironmentConfig-793daa60.js";import"./Dropdown-f05f24bf.js";import"./Toggle-edd22afa.js";import"./Suggestion-7a5f46c0.js";const M={class:"environment"},G={props:{modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(f,{emit:d}){const n=f,{t:S}=x(),u=y(JSON.parse(n.modelValue));function b(i,m){const v=u.value.supportedEnvironments.find(r=>r.type===i);Object.keys(v).map(r=>delete v[r]),Object.keys(m).map(r=>v[r]=m[r]),d("update:modelValue",JSON.stringify(u.value,void 0,4))}return T(()=>{try{const i=JSON.parse(n.modelValue);JSON.stringify(u.value)!==JSON.stringify(i)&&(u.value=i)}catch{}}),(i,m)=>(_(),E("div",M,[t(L,{"model-value":u.value.environment,"no-fields-message":a(S)("env.NoEnvFields"),"onUpdate:modelValue":m[0]||(m[0]=v=>b(i.env,v))},null,8,["model-value","no-fields-message"])]))}},P={class:"admin"},Q=["textContent"],W=["textContent"],X={class:"actions"},ie={props:{server:{type:Object,required:!0}},setup(f){const d=f,{t:n}=x(),S=O("toast"),u=O("events"),b=B();function i(){s.value=JSON.stringify(C.value,void 0,4),V.value=!0}function m(){V.value=!1}function v(){V.value=!1;const $=JSON.parse(s.value);d.server.updateDefinition($),C.value=$}function r(){u.emit("confirm",n("servers.ConfirmDelete",{name:d.server.name}),{text:n("servers.Delete"),icon:"remove",color:"error",action:async()=>{await d.server.delete(),S.success(n("servers.Deleted")),setTimeout(()=>{b.push({name:"ServerList"})},500)}},{color:"primary"})}const C=y({}),s=y(""),V=y(!1);return h(async()=>{d.server.hasScope("server.definition.view")&&(C.value=await d.server.getDefinition())}),($,e)=>{const N=q("hotkey");return _(),E("div",P,[D("h2",{textContent:c(a(n)("servers.Admin"))},null,8,Q),f.server.hasScope("server.definition.view")?U((_(),w(g,{key:0,variant:"text",onClick:e[0]||(e[0]=o=>i())},{default:l(()=>[t(j,{name:"edit"}),k(c(a(n)("servers.EditDefinition")),1)]),_:1},512)),[[N,"a e"]]):J("",!0),f.server.hasScope("server.delete")?(_(),w(g,{key:1,color:"error",onClick:e[1]||(e[1]=o=>r())},{default:l(()=>[t(j,{name:"remove"}),k(c(a(n)("servers.Delete")),1)]),_:1})):J("",!0),t(H,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=o=>V.value=o),class:"server-definition"},{default:l(()=>[t(R,null,{default:l(()=>[t(p,{id:"variables",title:a(n)("templates.Variables"),icon:"variables",hotkey:"t v"},{default:l(()=>[t(I,{modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=o=>s.value=o)},null,8,["modelValue"])]),_:1},8,["title"]),t(p,{id:"install",title:a(n)("templates.Install"),icon:"install",hotkey:"t i"},{default:l(()=>[t(z,{modelValue:s.value,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value=o)},null,8,["modelValue"])]),_:1},8,["title"]),t(p,{id:"run",title:a(n)("templates.RunConfig"),icon:"start",hotkey:"t r"},{default:l(()=>[t(F,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=o=>s.value=o)},null,8,["modelValue"])]),_:1},8,["title"]),t(p,{id:"hooks",title:a(n)("templates.Hooks"),icon:"hooks",hotkey:"t h"},{default:l(()=>[t(K,{modelValue:s.value,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value=o)},null,8,["modelValue"])]),_:1},8,["title"]),t(p,{id:"environment",title:a(n)("templates.Environment"),icon:"environment",hotkey:"t e"},{default:l(()=>[D("div",{class:"warning",textContent:c(a(n)("servers.EnvironmentEditHint"))},null,8,W),t(G,{modelValue:s.value,"onUpdate:modelValue":e[6]||(e[6]=o=>s.value=o)},null,8,["modelValue"])]),_:1},8,["title"]),t(p,{id:"json",title:a(n)("templates.Json"),icon:"json",hotkey:"t j"},{default:l(()=>[t(A,{id:"server-json",modelValue:s.value,"onUpdate:modelValue":e[7]||(e[7]=o=>s.value=o),class:"server-json-editor",mode:"json"},null,8,["modelValue"])]),_:1},8,["title"])]),_:1}),D("div",X,[U(t(g,{color:"error",onClick:e[8]||(e[8]=o=>m())},{default:l(()=>[t(j,{name:"close"}),k(c(a(n)("common.Cancel")),1)]),_:1},512),[[N,"Escape"]]),t(g,{disabled:!f.server.hasScope("server.definition.edit"),color:"primary",onClick:e[9]||(e[9]=o=>v())},{default:l(()=>[t(j,{name:"save"}),k(c(a(n)("common.Save")),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])])}}};export{ie as default};
//# sourceMappingURL=Admin-436bb24b.js.map
